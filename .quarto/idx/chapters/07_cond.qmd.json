{"title":"Conditional probability","markdown":{"headingText":"Conditional probability","containsRefs":false,"markdown":"\nThe probability of A **conditioned on** B is the updated probability of\nevent A after we learn that event B has occurred. Since events contain\ninformation, the occurring of a certain event may change our believes on\nprobabilities of other relevant events. The updated probability of event\nA after we learn that event B has occurred is the conditional\nprobability of A given B.\n\n::: {#def-cond}\nIf $A$ and $B$ are events with $P(B)>0$, then the conditional\nprobability of $A$ given $B$ is defined as\n$$P(A|B)=\\frac{P(A\\cap B)}{P(B)}.$$\n:::\n\n::: callout-note\n## Don't confuse P(A\\|B) with P(A,B)\n\n$P(A|B)$ is the probability of $A$ occurring given that $B$ has already\noccurred. While $P(A,B)=P(A\\cap B)$ is the probability that $A$ and $B$\noccur simultaneously.\n:::\n\n::: {#prp-cond}\nProperties of conditional probability:\n\n-   $P(A\\cap B)=P(B)P(A|B)=P(A)P(B|A)$\n\n-   $P(A_{1}\\cap\\cdots\\cap A_{n})=P(A_{1})P(A_{2}|A_{1})P(A_{3}|A_{1},A_{2})\\cdots P(A_{n}|A_{1}\\ldots A_{n-1})$\n:::\n\n::: {#thm-bayes}\n### Bayes' rule\n\nAssume $P(B)>0$, we have $$P(A|B)=\\dfrac{P(B|A)P(A)}{P(B)}$$\n:::\n\n::: callout-note\n## Thomas Bayes and \"causes and effects\"\n\nThe Bayes' rule is named after Thomas Bayes (18th century) who wanted\nto know how to infer causes from effects. Human intelligence wants to\nknow the cause given its effects. However, we are only able to observe\nthe effects given the cause. Here is Bayes' reasoning.\n\nSuppose we have a *prior* belief about the cause of something we want to learn.\nWe may not be able to learn the true cause directly, but after we observe its \neffects (the *Data*), we would update our belief based on the new information \nwe have learned from the data. The updated belief (the *posterior*) is therefore  somewhat closer to the \"truth\". \n\n$$\\underbrace{P(\\text{Belief | Data})}_{\\text{Posterier}}=\n\\frac{\\overbrace{P(\\text{Data | Belief})}^{\\text{Likelihood}}\\;\n\\overbrace{P(\\text{Belief})}^{\\text{Prior}} }{P(\\text{Data})}$$\n:::\n\n::: {#thm-lotp}\n### Law of total probability (LOTP)\n\nLet $B_{1},...,B_{n}$ be a partition of the sample space $S$ (i.e., the\n$B_{i}$ are disjoint events and their union is $S$), with $P(B_{i})>0$\nfor all $i$. Then $$P(A)=\\sum_{i=1}^{n}P(A|B_{i})P(B_{i}).$$\n:::\n\n::: {#thm-lotp-cond}\n### Conditional version of LOTP\n\nThe law of total probability has an analog conditional on another event\n$C$, namely, $$P(A|C) = \\sum_{i=1}^{n} P(A|B_i\\cap C)P(B_i|C).$$\n:::\n\n::: {#exm-1.7}\nGet a random 2-card hand from a standard deck. Find the probability of\n(a) Both cards are aces given that at least one of them (not necessarily\nthe first one) is an ace; (b) Getting another ace given the first draw\nis an ace of spade.\n:::\n\n::: solution\nThe example shows the subtleness of conditional probabilities. The\nseemingly indifferent probabilities are in fact different:\n$$\\begin{aligned} \nP(\\textrm{two aces | one ace}) \n&=\\frac{P(\\textrm{both aces})}{P(\\textrm{one ace})}\\\\\n&=\\frac{\\binom{4}{2}/\\binom{52}{2}}{1-\\binom{48}{2}/\\binom{52}{2}}\\\\\n&=\\frac{1}{33};\\\\\n& \\\\\nP(\\textrm{another ace | ace of spade})\n&=\\frac{P(\\textrm{ace of spade \\& another ace})}{P(\\textrm{ace of spade})}\\\\\n&=\\frac{\\binom{3}{1}/\\binom{52}{2}}{\\binom{51}{1}/\\binom{52}{2}}\\\\\n&=\\frac{1}{17}.\n\\end{aligned}$$\n\nNote that, in the first case, the denominator is interpreted as \"at\nleast one ace\"; whereas in the second case, it is \"ace of space +\nanother card\".\n:::\n\n::: {#exm-1.8}\nA disease has a prevalence rate of 10% (i.e., the probability of being\ninfected is 10%). A diagnostic test for the disease has an accuracy of\n98%, meaning it correctly identifies infected individuals as positive\n98% of the time. Calculate the probability that an individual is\ninfected given that the test result is positive.\n:::\n\n::: solution\nLet $D$ denote being actually infected by the disease; and $T$ denote a\npositive test. The test accuracy means: $P(T|D)=98\\%$. It also means\n$P(T|D^{C})=2\\%$. We also know that $P(D)=0.1$. We want to find\n$P(D|T)$. Note they are two different conditional probabilities, though\nwe mostly confuse the two in everyday life. The two conditional\nprobabilities are associated with Bayes' rule:\n$$\\begin{aligned}P(D|T)= & \\frac{P(T|D)P(D)}{P(T)}\\\\\n= & \\frac{P(T|D)P(D)}{P(T|D)P(D)+P(T|D^{C})P(D^{C})}\\\\\n= & \\frac{0.98\\times 0.1}{0.98\\times 0.1+0.02\\times 0.9}\\approx 84\\%.\n\\end{aligned}$$\n:::\n\nNote that how $P(T|D)$ is far away from $P(D|T)$!\n\n::: callout-note\n## Thinking conditionally\n\nAbraham Wald, the renowned statistician, was hired by the Statistical\nResearch Group (SRG) at Columbia University to figure out how to\nminimize the damage to bomber aircraft. The data they had comprised\naircraft returning from missions with bullet holes on their bodies. If\nasked which parts of the aircraft should be armored to enhance\nsurvivability, the obvious answer seemed to be to armor the damaged\nparts. However, Wald suggested the exact opposite---to armor the parts\nthat were not damaged. Why? Because the observed damage was conditioned\non the aircraft returning. If an aircraft had been damaged on other\nparts, it likely would not have returned. Thinking conditionally\ncompletely changes the answer!\n\n![](img/aircraft.png){width=\"50%\" fig-align=\"center\"}\n\nSee [The Soul of Statistics](http://www.youtube.com/watch?v=dzFf3r1yph8)\nby Professor Joseph Blitzstein.\n:::\n","srcMarkdownNoYaml":""},"formats":{"html":{"identifier":{"display-name":"HTML","target-format":"html","base-format":"html"},"execute":{"fig-width":7,"fig-height":5,"fig-format":"retina","fig-dpi":96,"df-print":"default","error":false,"eval":true,"cache":null,"freeze":false,"echo":true,"output":true,"warning":true,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"ipynb-shell-interactivity":null,"plotly-connected":true,"engine":"markdown"},"render":{"keep-tex":false,"keep-typ":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"html","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":"none","code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":"auto","merge-includes":true,"inline-includes":false,"preserve-yaml":false,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-min-runs":1,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[],"notebook-links":true},"pandoc":{"standalone":true,"wrap":"none","default-image-extension":"png","to":"html","output-file":"07_cond.html"},"language":{"toc-title-document":"Table of contents","toc-title-website":"On this page","related-formats-title":"Other Formats","related-notebooks-title":"Notebooks","source-notebooks-prefix":"Source","other-links-title":"Other Links","code-links-title":"Code Links","launch-dev-container-title":"Launch Dev Container","launch-binder-title":"Launch Binder","article-notebook-label":"Article Notebook","notebook-preview-download":"Download Notebook","notebook-preview-download-src":"Download Source","notebook-preview-back":"Back to Article","manuscript-meca-bundle":"MECA Bundle","section-title-abstract":"Abstract","section-title-appendices":"Appendices","section-title-footnotes":"Footnotes","section-title-references":"References","section-title-reuse":"Reuse","section-title-copyright":"Copyright","section-title-citation":"Citation","appendix-attribution-cite-as":"For attribution, please cite this work as:","appendix-attribution-bibtex":"BibTeX citation:","appendix-view-license":"View License","title-block-author-single":"Author","title-block-author-plural":"Authors","title-block-affiliation-single":"Affiliation","title-block-affiliation-plural":"Affiliations","title-block-published":"Published","title-block-modified":"Modified","title-block-keywords":"Keywords","callout-tip-title":"Tip","callout-note-title":"Note","callout-warning-title":"Warning","callout-important-title":"Important","callout-caution-title":"Caution","code-summary":"Code","code-tools-menu-caption":"Code","code-tools-show-all-code":"Show All Code","code-tools-hide-all-code":"Hide All Code","code-tools-view-source":"View Source","code-tools-source-code":"Source Code","tools-share":"Share","tools-download":"Download","code-line":"Line","code-lines":"Lines","copy-button-tooltip":"Copy to Clipboard","copy-button-tooltip-success":"Copied!","repo-action-links-edit":"Edit this page","repo-action-links-source":"View source","repo-action-links-issue":"Report an issue","back-to-top":"Back to top","search-no-results-text":"No results","search-matching-documents-text":"matching documents","search-copy-link-title":"Copy link to search","search-hide-matches-text":"Hide additional matches","search-more-match-text":"more match in this document","search-more-matches-text":"more matches in this document","search-clear-button-title":"Clear","search-text-placeholder":"","search-detached-cancel-button-title":"Cancel","search-submit-button-title":"Submit","search-label":"Search","toggle-section":"Toggle section","toggle-sidebar":"Toggle sidebar navigation","toggle-dark-mode":"Toggle dark mode","toggle-reader-mode":"Toggle reader mode","toggle-navigation":"Toggle navigation","crossref-fig-title":"Figure","crossref-tbl-title":"Table","crossref-lst-title":"Listing","crossref-thm-title":"Theorem","crossref-lem-title":"Lemma","crossref-cor-title":"Corollary","crossref-prp-title":"Proposition","crossref-cnj-title":"Conjecture","crossref-def-title":"Definition","crossref-exm-title":"Example","crossref-exr-title":"Exercise","crossref-ch-prefix":"Chapter","crossref-apx-prefix":"Appendix","crossref-sec-prefix":"Section","crossref-eq-prefix":"Equation","crossref-lof-title":"List of Figures","crossref-lot-title":"List of Tables","crossref-lol-title":"List of Listings","environment-proof-title":"Proof","environment-remark-title":"Remark","environment-solution-title":"Solution","listing-page-order-by":"Order By","listing-page-order-by-default":"Default","listing-page-order-by-date-asc":"Oldest","listing-page-order-by-date-desc":"Newest","listing-page-order-by-number-desc":"High to Low","listing-page-order-by-number-asc":"Low to High","listing-page-field-date":"Date","listing-page-field-title":"Title","listing-page-field-description":"Description","listing-page-field-author":"Author","listing-page-field-filename":"File Name","listing-page-field-filemodified":"Modified","listing-page-field-subtitle":"Subtitle","listing-page-field-readingtime":"Reading Time","listing-page-field-wordcount":"Word Count","listing-page-field-categories":"Categories","listing-page-minutes-compact":"{0} min","listing-page-category-all":"All","listing-page-no-matches":"No matching items","listing-page-words":"{0} words","listing-page-filter":"Filter","draft":"Draft"},"metadata":{"lang":"en","fig-responsive":true,"quarto-version":"1.7.29","editor":"source","theme":"cosmo","page-layout":"article","grid":{"sidebar-width":"300px","body-width":"900px","margin-width":"300px","gutter-width":"1.5rem"}},"extensions":{"book":{"multiFile":true}}},"pdf":{"identifier":{"display-name":"PDF","target-format":"pdf","base-format":"pdf"},"execute":{"fig-width":5.5,"fig-height":3.5,"fig-format":"pdf","fig-dpi":300,"df-print":"default","error":false,"eval":true,"cache":null,"freeze":false,"echo":true,"output":true,"warning":true,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"ipynb-shell-interactivity":null,"plotly-connected":true,"engine":"markdown"},"render":{"keep-tex":false,"keep-typ":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"pdf","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":"none","code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":true,"merge-includes":true,"inline-includes":false,"preserve-yaml":false,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-min-runs":1,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[]},"pandoc":{"pdf-engine":"xelatex","standalone":true,"variables":{"graphics":true,"tables":true},"default-image-extension":"pdf","to":"pdf","output-file":"07_cond.pdf"},"language":{"toc-title-document":"Table of contents","toc-title-website":"On this page","related-formats-title":"Other Formats","related-notebooks-title":"Notebooks","source-notebooks-prefix":"Source","other-links-title":"Other Links","code-links-title":"Code Links","launch-dev-container-title":"Launch Dev Container","launch-binder-title":"Launch Binder","article-notebook-label":"Article Notebook","notebook-preview-download":"Download Notebook","notebook-preview-download-src":"Download Source","notebook-preview-back":"Back to Article","manuscript-meca-bundle":"MECA Bundle","section-title-abstract":"Abstract","section-title-appendices":"Appendices","section-title-footnotes":"Footnotes","section-title-references":"References","section-title-reuse":"Reuse","section-title-copyright":"Copyright","section-title-citation":"Citation","appendix-attribution-cite-as":"For attribution, please cite this work as:","appendix-attribution-bibtex":"BibTeX citation:","appendix-view-license":"View License","title-block-author-single":"Author","title-block-author-plural":"Authors","title-block-affiliation-single":"Affiliation","title-block-affiliation-plural":"Affiliations","title-block-published":"Published","title-block-modified":"Modified","title-block-keywords":"Keywords","callout-tip-title":"Tip","callout-note-title":"Note","callout-warning-title":"Warning","callout-important-title":"Important","callout-caution-title":"Caution","code-summary":"Code","code-tools-menu-caption":"Code","code-tools-show-all-code":"Show All Code","code-tools-hide-all-code":"Hide All Code","code-tools-view-source":"View Source","code-tools-source-code":"Source Code","tools-share":"Share","tools-download":"Download","code-line":"Line","code-lines":"Lines","copy-button-tooltip":"Copy to Clipboard","copy-button-tooltip-success":"Copied!","repo-action-links-edit":"Edit this page","repo-action-links-source":"View source","repo-action-links-issue":"Report an issue","back-to-top":"Back to top","search-no-results-text":"No results","search-matching-documents-text":"matching documents","search-copy-link-title":"Copy link to search","search-hide-matches-text":"Hide additional matches","search-more-match-text":"more match in this document","search-more-matches-text":"more matches in this document","search-clear-button-title":"Clear","search-text-placeholder":"","search-detached-cancel-button-title":"Cancel","search-submit-button-title":"Submit","search-label":"Search","toggle-section":"Toggle section","toggle-sidebar":"Toggle sidebar navigation","toggle-dark-mode":"Toggle dark mode","toggle-reader-mode":"Toggle reader mode","toggle-navigation":"Toggle navigation","crossref-fig-title":"Figure","crossref-tbl-title":"Table","crossref-lst-title":"Listing","crossref-thm-title":"Theorem","crossref-lem-title":"Lemma","crossref-cor-title":"Corollary","crossref-prp-title":"Proposition","crossref-cnj-title":"Conjecture","crossref-def-title":"Definition","crossref-exm-title":"Example","crossref-exr-title":"Exercise","crossref-ch-prefix":"Chapter","crossref-apx-prefix":"Appendix","crossref-sec-prefix":"Section","crossref-eq-prefix":"Equation","crossref-lof-title":"List of Figures","crossref-lot-title":"List of Tables","crossref-lol-title":"List of Listings","environment-proof-title":"Proof","environment-remark-title":"Remark","environment-solution-title":"Solution","listing-page-order-by":"Order By","listing-page-order-by-default":"Default","listing-page-order-by-date-asc":"Oldest","listing-page-order-by-date-desc":"Newest","listing-page-order-by-number-desc":"High to Low","listing-page-order-by-number-asc":"Low to High","listing-page-field-date":"Date","listing-page-field-title":"Title","listing-page-field-description":"Description","listing-page-field-author":"Author","listing-page-field-filename":"File Name","listing-page-field-filemodified":"Modified","listing-page-field-subtitle":"Subtitle","listing-page-field-readingtime":"Reading Time","listing-page-field-wordcount":"Word Count","listing-page-field-categories":"Categories","listing-page-minutes-compact":"{0} min","listing-page-category-all":"All","listing-page-no-matches":"No matching items","listing-page-words":"{0} words","listing-page-filter":"Filter","draft":"Draft"},"metadata":{"block-headings":true,"editor":"source","documentclass":"scrreprt"},"extensions":{"book":{"selfContainedOutput":true}}}},"projectFormats":["html","pdf"]}