{"title":"Hypothesis testing","markdown":{"headingText":"Hypothesis testing","containsRefs":false,"markdown":"\nConfidence interval allows us to construct an interval estimate of a\npopulation parameter. Hypothesis testing allows us to test specific\nhypothesis about a population parameter with the evidence obtained from\na sample. The earliest use of statistical hypothesis testing is\ngenerally credited to the question of whether male and female births are\nequally likely (null hypothesis), which was addressed in the 1700s by\nJohn Arbuthnot and later by Pierre-Simon Laplace.\n\nLet $p$ be the population ratio (defined as the ratio of boys to the\ntotal number of babies). We hypotheses that $$H_{0}:p=0.5$$ This is\ncalled the **null hypothesis**, which is the hypothesis we want to test.\nIf the null hypothesis is false, we have $$H_{1}:p\\neq0.5$$ This is\ncalled the **alternative hypothesis**. How am I able to test which\nhypothesis is true? I can answer this question by collecting a small\nsample. Suppose I have collected a sample of $50$ babies computed a\nsample ratio of $\\hat{p}=0.55$. Does it prove or disprove the\nhypothesis?\n\nNote that the ratio $\\hat{p}$ can be regarded as a sample mean. Let\n$X_{i}$ be a random variable that equals $1$ if the $i$-th baby is a boy\nand $0$ otherwise. Then, $\\hat{p}=\\frac{1}{n}\\sum_{i=1}^{n}X_{i}$. The\nvariance of $\\hat{p}$ is given by\n$$Var(\\hat{p})=\\frac{1}{n^{2}}\\sum_{i=1}^{n}Var(X_{i})=\\frac{p(1-p)}{n}$$\nsince $X_{i}$ is a Bernoulli random variable. By the Central Limit\nTheorem, we have $$\\frac{\\hat{p}-p}{\\sqrt{\\frac{p(1-p)}{n}}}\\to N(0,1)$$\nSuppose $H_{0}$ is true, then we know the distribution of $\\hat{p}$. In\nparticular, there is 95% chance that $\\hat{p}$ would be in the interval\n$$p\\pm1.96\\sqrt{\\frac{p(1-p)}{n}}=0.5\\pm0.14$$ Our observed sample mean\n$\\hat{p}=0.55$ is not outrageous. It is well within this interval. [That\nmeans the evidence is not against the null hypothesis.]{.underline} It\ndoes not mean $H_{0}$ is true. But it is reasonable given we have\nobserved a sample mean $\\hat{p}=0.55$.\n\nSuppose we have observed $\\hat{p}=0.65$. This piece of evidence does not\nseem to be consistent with the null hypothesis. Because if $H_{0}$ is\ntrue, we only have less than 5% chance of observing this sample mean. It\nis extremely unlikely. Based on this sample, we are more inclined to\nreject the $H_{0}$. Rejecting the null hypothesis does not mean it is\nfalse, [but it means our evidence does not support this\nhypothesis.]{.underline}\n\n![](img/pvalue.jpg){width=\"60%\" fig-align=\"center\"}\n\n$p$**-value**: the probability of obtaining test results at least as\nextreme as the result actually observed, under the assumption that the\nnull hypothesis is correct. A very small $p$-value means that such an\nextreme observed outcome would be very unlikely under the null\nhypothesis. Thus, [The smaller the $p$-value, the stronger the evidence\nagainst the $H_{0}$.]{.underline}\n\nIn some studies, we can simply report the $p$-value and let people judge\nwhether the evidence is strong enough. In other studies, we prefer to\nselect a cut-off value $\\alpha$, call the **significance level**, and\nfollow the rule:\n\n-   If the $p\\textrm{-value}<\\alpha$, reject $H_{0}$;\n-   If the $p\\textrm{-value}>\\alpha$, do not reject $H_{0}$.\n\nCommonly used significance levels: $0.05$ and $0.01$. And we like to use\nthe word \"significant\" to describe the test result:\n\n-   A test with $p\\textrm{-value}<0.05$ is said to be (statistically)\n    **significant**;\n-   A test with $p\\textrm{-value}<0.01$ is said to be highly\n    **significant**.\n\nWhen we make a decision about accepting or rejecting a hypothesis, there\nare chances that we make a mistake. There are two types of mistakes:\n**Type 1 error** and **Type 2 error**.\n\n|     |                  |                |                        |\n|-----|------------------|:--------------:|------------------------|\n|     |                  |    Decision    |                        |\n|     |                  | Reject $H_{0}$ | Fail to reject $H_{0}$ |\n|     | $H_{0}$ is true  |  Type 1 error  | $\\checkmark$           |\n|     | $H_{0}$ is false |  $\\checkmark$  | Type 2 error           |\n\n**Type 1 error** is rejecting the $H_{0}$ when it is true. **Type 2\nerror** is failing to reject the $H_{0}$ when it is false. Usually, it\nis more important to control the Type 1 error than the the Type 2 error.\nThat is, we want to minimize the chance of falsely rejecting the null\nhypothesis.\n\nIn the example above, we reject the null hypothesis on the ground that\nthere is only 2.3% of the chance that we could observe this sample.\nTherefore, the probability of Type 1 error is only 2.3%.\n\nIf we make decisions based on a significance level, the significance\nlevel is the Type 1 error rate. In other words, when using a 5%\nsignificance level, there is 5% chance of making a Type 1 error.\n\n$$P(\\textrm{Type 1 error}|H_{0}\\textrm{ is true})=\\alpha$$\n\nThis is why we prefer small values of $\\alpha$---smaller $\\alpha$\nreduces the Type 1 error rate. However, significance level doesn't\ncontrol Type 2 error rate.\n\n### Hypothesis testing with $z$-statistics {.unnumbered}\n\nWe may have noticed that, in the above example, the assumption that the\npopulation $\\sigma$ is known is unrealistic. In practice, we approximate\nit with the standard error $s/\\sqrt{n}$. The approximate is valid if the\nthe sample size is large enough or the underlying distribution is nearly\nnormal. If this is not the case, we would opt for a $t$-test. Here we\nsummarize the steps of testing for a population mean with\n$z$-statistics.\n\nWe notice that the **two-sided** hypothesis tests are very closed\nrelated to the concept of confidence intervals. A two-sided test means\nwe are interested in rejection regions on both sides of the tail\ndistribution. Typically, the alternative hypothesis is\n$H_{1}:\\mu\\neq\\mu_{0}$.\n\n![](img/twosides.png){width=\"80%\" fig-align=\"center\"}\n\nSuppose we are doing a hypothesis test under the significance level\n$\\alpha$, the region of accepting the $H_{0}$ is\n\n$$-z_{\\alpha/2}\\leq\\frac{\\bar{X}-\\mu}{SE}\\leq z_{\\alpha/2}$$\n\nsuch that the rejection region ($p$-value) has probability $\\alpha$.\nThis is equivalent to\n$$\\bar{X}-z_{\\alpha/2}SE\\leq\\mu\\leq\\bar{X}+z_{\\alpha/2}SE$$\n\nwhich is exactly the $100(1-\\alpha)\\%$ confidence interval of $\\bar{X}$.\nTherefore, for a two-sided test, we have the rule:\n\n-   Reject $H_{0}$ if $\\mu$ is not in the $100(1-\\alpha)\\%$ CI:\n    $\\bar{X}\\pm z_{\\alpha/2}SE$\n\nWe conclude this chapter by reiterating a couple of critical points that\ncould be easily misunderstood.\n\nRejecting $H_{0}$ doesn't means we are 100% sure that $H_{0}$ is false.\nWe might make Type 1 errors. Setting a significance level just guarantee\nwe won't make Type 1 error too often.\n\nFailing to reject $H_{0}$ does not necessarily mean $H_{0}$ is true. We\ncould make a type 2 error when failing to reject $H_{0}$. Moreover,\nunlike type 1 error rate is controlled at a low level, type 2 error rate\nis usually quite high. When we fail to reject $H_{0}$, it just means the\ndata are not able to distinguish between $H_{0}$ and $H_{1}$. That's why\nwe say *fail to reject*. [$p$-value is not the probability that the\n$H_{0}$ is true.]{.underline}\n\nSaying that results are statistically significant just informs the\nreader that the findings are unlikely due to chance alone. However, it\nsays nothing about the practical importance of the finding. For example,\nrejecting the $H_{0}$: $\\mu=\\mu_{0}$ does not tell us how big the\ndifference $|\\mu-\\mu_{0}|$ is. Mostly in practice we care more about the\nmagnitude of this difference, rather than the fact that they are indeed\ndifferent. It is possible that the difference is too small to be\nrelevant even if it is significant.\n\n### Hypothesis testing with $t$-statistics {.unnumbered}\n\nWhen the sample size is small, we opt for $t$-test for more reliable\nhypothsis testing. Define test statistics\n$$T=\\frac{\\bar{X}-\\mu}{s/\\sqrt{n}}$$ where $s$ is the sample standard\ndeviation. For small samples, this test statistics follows a Student\n$t$-distribution with $n$ degrees of freedom, $T\\sim t(n)$.\n\nWhy Student-$t$ distribution? Recall the definition of Student-$t$\ndistribution: when the underlying distribution of\n$X_{1},X_{2},\\dots,X_{n}$ is Normal, sample variance $s^{2}$ follows a\n$\\chi^{2}$ distribution. $T$ follows $t$ distribution by definition\nregardless of the sample size. However, if the underlying distribution\nis not normal, this argument loses ground. We use $t$-test mainly as a\nconvention. But $t$ distribution has heavier tails than standard normal,\nmeaning that we are more likely to reject a hypothesis based on $t$\ndistribution. In other words, $t$-test is a more conservative choice\nthan $z$-test for small samples.\n\n|                   |       |       |       |\n|:-----------------:|:-----:|:-----:|:-----:|\n| one-tail $\\alpha$ | 0.05  | 0.025 | 0.005 |\n| two-tail $\\alpha$ | 0.10  | 0.05  | 0.01  |\n|       d.f.        |       |       |       |\n|        10         | 1.812 | 2.228 | 3.169 |\n|        20         | 1.725 | 2.086 | 2.845 |\n|        30         | 1.697 | 2.042 | 2.750 |\n|     $z$ value     | 1.645 | 1.960 | 2.576 |\n\nThe table shows a few critical values for $t$-test with different\ndegrees of freedom (d.f.). We can see as the sample size gets larger,\n$t$ distribution converges to standard normal.\n","srcMarkdownNoYaml":""},"formats":{"html":{"identifier":{"display-name":"HTML","target-format":"html","base-format":"html"},"execute":{"fig-width":7,"fig-height":5,"fig-format":"retina","fig-dpi":96,"df-print":"default","error":false,"eval":true,"cache":null,"freeze":false,"echo":true,"output":true,"warning":true,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"ipynb-shell-interactivity":null,"plotly-connected":true,"engine":"markdown"},"render":{"keep-tex":false,"keep-typ":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"html","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":"none","code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":"auto","merge-includes":true,"inline-includes":false,"preserve-yaml":false,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-min-runs":1,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[],"notebook-links":true},"pandoc":{"standalone":true,"wrap":"none","default-image-extension":"png","to":"html","output-file":"55_ht.html"},"language":{"toc-title-document":"Table of contents","toc-title-website":"On this page","related-formats-title":"Other Formats","related-notebooks-title":"Notebooks","source-notebooks-prefix":"Source","other-links-title":"Other Links","code-links-title":"Code Links","launch-dev-container-title":"Launch Dev Container","launch-binder-title":"Launch Binder","article-notebook-label":"Article Notebook","notebook-preview-download":"Download Notebook","notebook-preview-download-src":"Download Source","notebook-preview-back":"Back to Article","manuscript-meca-bundle":"MECA Bundle","section-title-abstract":"Abstract","section-title-appendices":"Appendices","section-title-footnotes":"Footnotes","section-title-references":"References","section-title-reuse":"Reuse","section-title-copyright":"Copyright","section-title-citation":"Citation","appendix-attribution-cite-as":"For attribution, please cite this work as:","appendix-attribution-bibtex":"BibTeX citation:","appendix-view-license":"View License","title-block-author-single":"Author","title-block-author-plural":"Authors","title-block-affiliation-single":"Affiliation","title-block-affiliation-plural":"Affiliations","title-block-published":"Published","title-block-modified":"Modified","title-block-keywords":"Keywords","callout-tip-title":"Tip","callout-note-title":"Note","callout-warning-title":"Warning","callout-important-title":"Important","callout-caution-title":"Caution","code-summary":"Code","code-tools-menu-caption":"Code","code-tools-show-all-code":"Show All Code","code-tools-hide-all-code":"Hide All Code","code-tools-view-source":"View Source","code-tools-source-code":"Source Code","tools-share":"Share","tools-download":"Download","code-line":"Line","code-lines":"Lines","copy-button-tooltip":"Copy to Clipboard","copy-button-tooltip-success":"Copied!","repo-action-links-edit":"Edit this page","repo-action-links-source":"View source","repo-action-links-issue":"Report an issue","back-to-top":"Back to top","search-no-results-text":"No results","search-matching-documents-text":"matching documents","search-copy-link-title":"Copy link to search","search-hide-matches-text":"Hide additional matches","search-more-match-text":"more match in this document","search-more-matches-text":"more matches in this document","search-clear-button-title":"Clear","search-text-placeholder":"","search-detached-cancel-button-title":"Cancel","search-submit-button-title":"Submit","search-label":"Search","toggle-section":"Toggle section","toggle-sidebar":"Toggle sidebar navigation","toggle-dark-mode":"Toggle dark mode","toggle-reader-mode":"Toggle reader mode","toggle-navigation":"Toggle navigation","crossref-fig-title":"Figure","crossref-tbl-title":"Table","crossref-lst-title":"Listing","crossref-thm-title":"Theorem","crossref-lem-title":"Lemma","crossref-cor-title":"Corollary","crossref-prp-title":"Proposition","crossref-cnj-title":"Conjecture","crossref-def-title":"Definition","crossref-exm-title":"Example","crossref-exr-title":"Exercise","crossref-ch-prefix":"Chapter","crossref-apx-prefix":"Appendix","crossref-sec-prefix":"Section","crossref-eq-prefix":"Equation","crossref-lof-title":"List of Figures","crossref-lot-title":"List of Tables","crossref-lol-title":"List of Listings","environment-proof-title":"Proof","environment-remark-title":"Remark","environment-solution-title":"Solution","listing-page-order-by":"Order By","listing-page-order-by-default":"Default","listing-page-order-by-date-asc":"Oldest","listing-page-order-by-date-desc":"Newest","listing-page-order-by-number-desc":"High to Low","listing-page-order-by-number-asc":"Low to High","listing-page-field-date":"Date","listing-page-field-title":"Title","listing-page-field-description":"Description","listing-page-field-author":"Author","listing-page-field-filename":"File Name","listing-page-field-filemodified":"Modified","listing-page-field-subtitle":"Subtitle","listing-page-field-readingtime":"Reading Time","listing-page-field-wordcount":"Word Count","listing-page-field-categories":"Categories","listing-page-minutes-compact":"{0} min","listing-page-category-all":"All","listing-page-no-matches":"No matching items","listing-page-words":"{0} words","listing-page-filter":"Filter","draft":"Draft"},"metadata":{"lang":"en","fig-responsive":true,"quarto-version":"1.7.29","editor":"source","theme":"cosmo","page-layout":"article","grid":{"sidebar-width":"300px","body-width":"900px","margin-width":"300px","gutter-width":"1.5rem"}},"extensions":{"book":{"multiFile":true}}},"pdf":{"identifier":{"display-name":"PDF","target-format":"pdf","base-format":"pdf"},"execute":{"fig-width":5.5,"fig-height":3.5,"fig-format":"pdf","fig-dpi":300,"df-print":"default","error":false,"eval":true,"cache":null,"freeze":false,"echo":true,"output":true,"warning":true,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"ipynb-shell-interactivity":null,"plotly-connected":true,"engine":"markdown"},"render":{"keep-tex":false,"keep-typ":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"pdf","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":"none","code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":true,"merge-includes":true,"inline-includes":false,"preserve-yaml":false,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-min-runs":1,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[]},"pandoc":{"pdf-engine":"xelatex","standalone":true,"variables":{"graphics":true,"tables":true},"default-image-extension":"pdf","to":"pdf","output-file":"55_ht.pdf"},"language":{"toc-title-document":"Table of contents","toc-title-website":"On this page","related-formats-title":"Other Formats","related-notebooks-title":"Notebooks","source-notebooks-prefix":"Source","other-links-title":"Other Links","code-links-title":"Code Links","launch-dev-container-title":"Launch Dev Container","launch-binder-title":"Launch Binder","article-notebook-label":"Article Notebook","notebook-preview-download":"Download Notebook","notebook-preview-download-src":"Download Source","notebook-preview-back":"Back to Article","manuscript-meca-bundle":"MECA Bundle","section-title-abstract":"Abstract","section-title-appendices":"Appendices","section-title-footnotes":"Footnotes","section-title-references":"References","section-title-reuse":"Reuse","section-title-copyright":"Copyright","section-title-citation":"Citation","appendix-attribution-cite-as":"For attribution, please cite this work as:","appendix-attribution-bibtex":"BibTeX citation:","appendix-view-license":"View License","title-block-author-single":"Author","title-block-author-plural":"Authors","title-block-affiliation-single":"Affiliation","title-block-affiliation-plural":"Affiliations","title-block-published":"Published","title-block-modified":"Modified","title-block-keywords":"Keywords","callout-tip-title":"Tip","callout-note-title":"Note","callout-warning-title":"Warning","callout-important-title":"Important","callout-caution-title":"Caution","code-summary":"Code","code-tools-menu-caption":"Code","code-tools-show-all-code":"Show All Code","code-tools-hide-all-code":"Hide All Code","code-tools-view-source":"View Source","code-tools-source-code":"Source Code","tools-share":"Share","tools-download":"Download","code-line":"Line","code-lines":"Lines","copy-button-tooltip":"Copy to Clipboard","copy-button-tooltip-success":"Copied!","repo-action-links-edit":"Edit this page","repo-action-links-source":"View source","repo-action-links-issue":"Report an issue","back-to-top":"Back to top","search-no-results-text":"No results","search-matching-documents-text":"matching documents","search-copy-link-title":"Copy link to search","search-hide-matches-text":"Hide additional matches","search-more-match-text":"more match in this document","search-more-matches-text":"more matches in this document","search-clear-button-title":"Clear","search-text-placeholder":"","search-detached-cancel-button-title":"Cancel","search-submit-button-title":"Submit","search-label":"Search","toggle-section":"Toggle section","toggle-sidebar":"Toggle sidebar navigation","toggle-dark-mode":"Toggle dark mode","toggle-reader-mode":"Toggle reader mode","toggle-navigation":"Toggle navigation","crossref-fig-title":"Figure","crossref-tbl-title":"Table","crossref-lst-title":"Listing","crossref-thm-title":"Theorem","crossref-lem-title":"Lemma","crossref-cor-title":"Corollary","crossref-prp-title":"Proposition","crossref-cnj-title":"Conjecture","crossref-def-title":"Definition","crossref-exm-title":"Example","crossref-exr-title":"Exercise","crossref-ch-prefix":"Chapter","crossref-apx-prefix":"Appendix","crossref-sec-prefix":"Section","crossref-eq-prefix":"Equation","crossref-lof-title":"List of Figures","crossref-lot-title":"List of Tables","crossref-lol-title":"List of Listings","environment-proof-title":"Proof","environment-remark-title":"Remark","environment-solution-title":"Solution","listing-page-order-by":"Order By","listing-page-order-by-default":"Default","listing-page-order-by-date-asc":"Oldest","listing-page-order-by-date-desc":"Newest","listing-page-order-by-number-desc":"High to Low","listing-page-order-by-number-asc":"Low to High","listing-page-field-date":"Date","listing-page-field-title":"Title","listing-page-field-description":"Description","listing-page-field-author":"Author","listing-page-field-filename":"File Name","listing-page-field-filemodified":"Modified","listing-page-field-subtitle":"Subtitle","listing-page-field-readingtime":"Reading Time","listing-page-field-wordcount":"Word Count","listing-page-field-categories":"Categories","listing-page-minutes-compact":"{0} min","listing-page-category-all":"All","listing-page-no-matches":"No matching items","listing-page-words":"{0} words","listing-page-filter":"Filter","draft":"Draft"},"metadata":{"block-headings":true,"editor":"source","documentclass":"scrreprt"},"extensions":{"book":{"selfContainedOutput":true}}}},"projectFormats":["html","pdf"]}