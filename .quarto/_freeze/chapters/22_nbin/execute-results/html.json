{
  "hash": "4eb0ef70ec6d4c051e0790b94af2d6b5",
  "result": {
    "engine": "knitr",
    "markdown": "# Negative Binomial\n\n::: {#def-nbin}\n### Negative Binomial distribution\n\nIn a sequence of independent Bernoulli trials with success probability $p$, if $X$ is the number of failures before the $r$-th success, then $X$ is said to have a Negative Binomial distribution, denoted $X\\sim\\textrm{NBin}(r,p)$.\n:::\n\nThe PMF for Negative Binomial distribution is given by\n\n$$P(X=k)=\\binom{k+r-1}{r-1}q^{k}p^{r}.$$\n\nTo compute the expectation, let $X=X_{1}+\\cdots+X_{r}$ where $X_{i}$ is the number of failures between the $(i-1)$-th success and the $i$-th success, $1\\leq i\\leq r$. Then $X_{i}\\sim\\textrm{Geom}(p)$. By linearity of expectations,\n\n$$E(X)=E(X_{1})+\\cdots+E(X_{r})=r\\frac{1-p}{p}.$$\n\n::: {#thm-nbin}\nLet $X_1,X_2,...,X_n$ be independent geometric distributions with the same parameter $p$. Then $$X=X_1+X_2+\\cdots+X_n$$ is a negative binomial distribution, namely $X\\sim\\text{NBin}(n,p)$.\n:::\n\nThe theorem is straightforward if we interpret $X_1$ as the number of failures before the 1st success, $X_2$ as the number of failures between the 1st and 2nd successes, and $X_n$ be the number of failures between the $(n-1)$-th and $n$-th successes.\n\n::: {#exm-toy}\n### Toy collection\n\nThere are $n$ types of toys. Assume each time you buy a toy, it is equally likely to be any of the $n$ types. What is the expected number of toys you need to buy until you have a complete set?\n:::\n\n::: solution\nDefine the following random variables: $$\\begin{aligned}T= & T_{1}+T_{2}+\\cdots+T_{n}\\\\\nT_{1}= & \\textrm{number of toys until 1st new type}\\\\\nT_{2}= & \\textrm{additional number of toys until 2nd new type}\\\\\nT_{3}= & \\textrm{additional number of toys until 3rd new type}\\\\\n\\vdots\n\\end{aligned}$$\n\nWe know, $T_{1}=1$, $T_{2}-1\\sim\\textrm{Geom}\\left(\\frac{n-1}{n}\\right)$,..., $T_{j}-1\\sim\\textrm{Geom}\\left(\\frac{n-(j-1)}{n}\\right)$. Thus, $$\\begin{aligned}E(T)= & E(T_{1})+E(T_{2})+\\cdots+E(T_{n})\\\\\n= & 1+\\frac{n}{n-1}+\\frac{n}{n-2}+\\cdots+\\frac{1}{n}\\\\\n= & n(1+\\frac{1}{2}+\\frac{1}{3}+\\cdots+\\frac{1}{n})\\\\\n\\to & n(\\log n+0.577).\n\\end{aligned}$$\n\nIf $n=5$, $E(T)\\approx11$; if $n=10$, $E(T)\\approx29$.\n:::\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# number of simulations\nN <- 1000\n\n# number of toys bought in each simulation\nX <- numeric(N)\n\n# the set of toys\nToys <- c('ðŸ§¸','ðŸ¢','ðŸ£','ðŸ¤','ðŸ¼','ðŸ¤–','ðŸ¸','ðŸ·')\n\nset.seed(100)\n\n# run simulation\nfor (i in 1:N) {\n  C <- c() # the collection of toys bought\n  # repeat until a full set is collected\n  while(TRUE) {\n    t <- sample(Toys, 1, replace=T)\n    C <- c(C, t)\n    if(setequal(C, Toys)) break\n  }\n  X[i] <- length(C)\n}\n\nhist(X, probability = T)\nabline(v = mean(X), col = 2)\n```\n\n::: {.cell-output-display}\n![](22_nbin_files/figure-html/unnamed-chunk-1-1.png){width=672}\n:::\n:::\n\n",
    "supporting": [
      "22_nbin_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}