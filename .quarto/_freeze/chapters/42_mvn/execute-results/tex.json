{
  "hash": "cb2483d532aff3e8197a6c0711ee4ea3",
  "result": {
    "engine": "knitr",
    "markdown": "## Multivariate normal*\n\n::: {#def-mvn}\n## Bivariate normal distribution\n\n$(X,Y)$ is said to have a Bivariate Normal distribution if the joint PDF\nsatisfies\n$$f(x,y)=\\frac{1}{2\\pi\\sqrt{1-\\rho^{2}}}\\exp\\left(-\\frac{1}{2(1-\\rho^{2})}(x^{2}+y^{2}-2\\rho xy)\\right)$$\nwhere $\\rho\\in(-1,1)$ is the correlation between $X$ and $Y$.\n:::\n\n::: {layout-ncol=\"2\"}\n![](img/binorm1.png)\n\n![](img/binorm2.png)\n:::\n\n**Multivariate Normal (MVN)** is an extension of the bivariate normal\ndistribution to $n$-dimensional variables. We skip the joint PDF here\nsince it is too complicated. But like the bivariate case, an MVN is\nfully specified by knowing the mean of each component, the variance of\neach component, and the covariance between any two components.\n\n::: callout-caution\n## Marginal normality does not imply joint normality\n\nIf $(X_{1},...,X_{k})$ is MVN, then the marginal distribution of every\n$X_{j}$ is Normal. However, the converse is false: it is possible to\nhave Normally distributed $X_{1},...,X_{k}$ such that\n$(X_{1},...,X_{k})$ is not Multivariate Normal.\n:::\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Load necessary library\nlibrary(MASS)\n\n# Set seed for reproducibility\nset.seed(123)\n\n# Generate bivariate normal data\nbvn_data <- mvrnorm(n = 1000, \n                    mu = c(0, 0), \n                    Sigma = matrix(c(1, 0.5, 0.5, 1), nrow = 2))\n\n# Modify the joint distribution: apply a nonlinear transformation\nbvn_data[, 2] <- bvn_data[, 2] + 2 * sin(bvn_data[, 1]) \n\n# The marginal distribution remains normal\npar(mfrow = c(1, 3))\nhist(bvn_data[, 1], main = \"Marginal X1\", col = \"lightblue\")\nhist(bvn_data[, 2], main = \"Marginal X2\", col = \"lightblue\")\n\n# But the joint distribution is not normal\nplot(bvn_data, main = \"Joint Distribution\", pch = 16, col = rgb(1,0,0,.2))\n```\n\n::: {.cell-output-display}\n![](42_mvn_files/figure-pdf/unnamed-chunk-1-1.pdf){fig-pos='H'}\n:::\n:::\n\n\n::: {#thm-mvn}\nA random vector $(X_{1},...,X_{k})$ is Multivariate Normal if every\nlinear combination of the $X_{j}$ has a Normal distribution ($X_{j}$ do\nnot have to be independent). That is, we require\n$t_{1}X_{1}+\\cdot\\cdot\\cdot+t_{k}X_{k}$ to have a Normal distribution\nfor any choice of constants $t_{1},...,t_{k}$.\n:::\n\n::: {#thm-mvn-corr}\nIn general, uncorrelated does not imply independent. But with an MVN\nrandom vector, uncorrelated implies independent. In particular, if\n$(X,Y)$ is Bivariate Normal and $\\rho_{XY}=0$, then X and Y are\nindependent.\n:::\n\n::: {#thm-mvn-condexp}\nIf $(X,Y)$ is Bivariate Normal, then the conditional expectation\nsatisfies $$E(Y|X)=E(Y)+\\frac{Cov(X,Y)}{Var(X)}(X-E(X)).$$\n\nIn other words, $$E(Y|X)=a+bX$$where $b=\\frac{Cov(X,Y)}{Var(X)}$ and\n$a=E(Y)-bE(X)$.\n:::\n\nThis is exactly the case in @def-lm, where we assume the conditional\nexpectation $E(Y|X)$ is a linear function of $X$. This assumption is\ntrue when $(X,Y)$ are jointly normal. Otherwise, the assumption might\nnot be reasonable. In practice, we don't know precisely the joint\ndistribution of variables. The linear model is just a simplified\nassumption.\n",
    "supporting": [
      "42_mvn_files/figure-pdf"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {
      "knitr": [
        "{\"type\":\"list\",\"attributes\":{},\"value\":[]}"
      ]
    },
    "preserve": null,
    "postProcess": false
  }
}